var Form=function(a,b,d,e,c){var f=this;b=void 0===b?null:b;d=void 0===d?null:d;e=void 0===e?null:e;c=void 0===c?null:c;this.m_parent=a;this.m_parent.addEventListener("submit",function(a){f.submit(a)},!1);this.m_callbackSuccess=b;this.m_callbackError=d;this.m_statusBearer=e;this.m_progressBar=c;this.m_progressBarProgress=c.querySelector(".progress");this.m_currentXHR=null;this.m_loadingInProgress=!1;this.m_loadingStatus={NONE:0,LOADING:1,LOADED:2,FAILED:3}};
Form.prototype.setDisabled=function(a){this.m_parent.querySelectorAll("input").forEach(function(b){b.readOnly=a});this.m_parent.querySelectorAll("textarea").forEach(function(b){b.readOnly=a});this.m_parent.querySelectorAll("button").forEach(function(b){b.readOnly=a});this.m_parent.querySelectorAll("select").forEach(function(b){b.readOnly=a});this.m_parent.querySelectorAll("button[type=reset]").forEach(function(b){b.disabled=a})};
Form.prototype.clear=function(){var a=this;setTimeout(function(){a.setLoadingStatus(a.m_loadingStatus.NONE)},1500)};
Form.prototype.setLoadingStatus=function(a){switch(a){case this.m_loadingStatus.NONE:this.setDisabled(!1);this.m_currentXHR=null;this.m_loadingInProgress=!1;this.m_progressBar.classList.remove("shown");break;case this.m_loadingStatus.LOADING:this.setDisabled(!0);this.m_loadingInProgress=!0;this.m_progressBar.classList.add("shown");break;case this.m_loadingStatus.LOADED:this.setDisabled(!1);this.m_currentXHR=null;this.m_loadingInProgress=!1;this.m_progressBar.classList.remove("shown");break;case this.m_loadingStatus.FAILED:this.setDisabled(!1),
this.m_currentXHR=null,this.m_loadingInProgress=!1,this.m_progressBar.classList.remove("shown")}if(null!==this.m_statusBearer)switch(this.m_statusBearer.classList.remove("loading"),this.m_statusBearer.classList.remove("loaded"),this.m_statusBearer.classList.remove("failed"),a){case this.m_loadingStatus.LOADING:this.m_statusBearer.classList.add("loading");break;case this.m_loadingStatus.LOADED:this.m_statusBearer.classList.add("loaded");break;case this.m_loadingStatus.FAILED:this.m_statusBearer.classList.add("failed")}};
Form.prototype.submit=function(a){var b=this;a=void 0===a?null:a;null!==a&&a.preventDefault();if(!this.m_loadingInProgress){this.setLoadingStatus(this.m_loadingStatus.LOADING);null!==this.m_progressBar&&this.m_progressBar.classList.add("shown");a=this.m_parent.action;var d=new FormData(this.m_parent);this.m_currentXHR=SimpleRequest.post(a,d,function(a){b.load(a)},function(a){b.error(a)},function(a){b.abort(a)},function(a,c){b.progress(a,c)},{encode_uri:!1})}};
Form.prototype.load=function(a){this.setLoadingStatus(this.m_loadingStatus.LOADED);this.clear();null!==this.m_callbackSuccess&&this.m_callbackSuccess(a)};Form.prototype.error=function(a){a=void 0===a?null:a;this.setLoadingStatus(this.m_loadingStatus.FAILED);this.clear();null!==this.m_callbackError&&this.m_callbackError(a)};Form.prototype.abort=function(a){null!==this.m_currentXHR&&this.m_currentXHR.abort();this.setLoadingStatus(this.m_loadingStatus.NONE)};
Form.prototype.progress=function(a,b){null!==this.m_progressBar&&(this.m_progressBarProgress.style.width=a/b*100+"%")};
