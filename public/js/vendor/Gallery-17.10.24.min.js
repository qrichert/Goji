/*
	Copyright Â© 2017 Quentin Richert <https://www.quentinrichert.com/>
	Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License
	See http://creativecommons.org/licenses/by-nc-nd/4.0/
	Please contact the author for commercial use.
*/

function Gallery(n,c,g){c=void 0===c?4:c;g=void 0===g?c:g;var e=this,a=0;this.m_parent=n;this.m_parent.style.display="flex";this.m_parent.style.flexDirection="row";this.m_parent.style.flexWrap="wrap";this.m_parent.style.justifyContent="space-between";this.m_parent.style.alignItems="flex-start";this.m_parent.style.alignContent="flex-start";this.m_parent.style.padding="0";this.m_parentWidth=this.m_parent.offsetWidth;window.addEventListener("resize",function(){e.m_parentWidth=e.m_parent.offsetWidth;
e.m_currentState=e.getCurrentState();e.recalculateSizes()},!1);this.m_parents=[];this.m_images=[];this.m_spaceAround=Number(c);this.m_spaceUnder=Number(g);this.updateImages=function(){this.m_parents=[];this.m_images=[];for(a=0;a<this.m_parent.children.length;a++)this.m_parents.push(this.m_parent.children[a]),this.m_images.push(this.m_parents[a].getElementsByClassName("gallery-element")[0]),this.m_parents[a].style.marginTop="0",this.m_parents[a].style.marginRight="0",this.m_parents[a].style.marginBottom=
this.m_spaceUnder+"px",this.m_parents[a].style.marginLeft="0",this.m_images[a].style.width="100%",this.m_images[a].style.height="100%",this.m_images[a].style.padding="0",this.m_images[a].style.margin="0",this.m_images[a].style.objectFit="cover";var l=null;for(a=0;a<this.m_images.length;a++){var d=Number(this.m_images[a].dataset.height);null==l&&(l=d);d>l&&(l=d)}for(a=0;a<this.m_images.length;a++){var f=Number(this.m_images[a].dataset.width);d=Number(this.m_images[a].dataset.height);if(d!=l){var b=
d/l;this.m_images[a].dataset.width=f/b;this.m_images[a].dataset.height=d/b}}this.recalculateSizes()};this.m_currentState=null;this.getCurrentState=function(){if(600>=this.m_parentWidth)return 1;if(750>=this.m_parentWidth)return 2;if(1020>=this.m_parentWidth)return 3;if(1600>=this.m_parentWidth)return 4;if(2500>=this.m_parentWidth)return 5;if(2500<this.m_parentWidth)return 6};this.m_currentState=this.getCurrentState();this.recalculateSizes=function(){var a=-1,d=this.m_images.length,f=3;switch(this.m_currentState){case 1:f=
1;break;case 2:f=2;break;case 3:f=3;break;case 4:f=4;break;case 5:f=5;break;case 6:f=6}if(1==this.m_currentState)for(var b=0;b<this.m_images.length;b++)this.m_parents[b].style.width="100%",this.m_parents[b].style.height="100%",this.m_parents[b].style.marginRight="0",this.m_parents[b].style.marginLeft="0";else for(;a<d-1;){var h=f;a+h>d-1&&(h=d-1-a);var c=[];var k=0,m=a+1;for(b=m;b<=a+h;b++)if(b==m)c.push(1),k+=Number(this.m_images[m].dataset.width);else{var e=Number(this.m_images[m].dataset.height)/
Number(this.m_images[b].dataset.height);c.push(e);k+=Number(this.m_images[b].dataset.width)*e}c=b=k/this.m_parentWidth;k=m=0;for(b=a+1;b<=a+h;b++){e=Number(this.m_images[b].dataset.height)/c;var g=Number(this.m_images[b].dataset.width)/c/this.m_parentWidth*this.m_parentWidth-this.m_spaceAround*(h-1)/h;k+=g;b==a+h&&k>this.m_parentWidth&&(g-=k-this.m_parentWidth);this.m_parents[b].style.width=g+"px";this.m_parents[b].style.height=e+"px";m++}a+=h}};this.updateImages();this.recalculateSizes()};
