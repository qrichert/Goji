/*
	Copyright Â© 2017 Quentin Richert <https://www.quentinrichert.com/>
	Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License
	See http://creativecommons.org/licenses/by-nc-nd/4.0/
	Please contact the author for commercial use.
*/

function Perspective(q,p,h,k,l){function r(m){var b=Date.now();if(!(b-a.m_timer<a.m_frameRate)){timer=b;b=m.accelerationIncludingGravity.x;var c=m.accelerationIncludingGravity.y;0==n&&(a.m_initialX=b,a.m_initialY=c,n=!0);b>a.m_initialX?b=Math.abs(a.m_initialX-b):b<a.m_initialX&&(b=-Math.abs(a.m_initialX-b));c>a.m_initialY?c=Math.abs(a.m_initialY-c):c<a.m_initialY&&(c=-Math.abs(a.m_initialY-c));if(null==a.m_oldAccelerationX||null==a.oldAccelerationY)a.m_oldAccelerationX=b,a.m_oldAccelerationY=c;Math.abs(a.m_oldAccelerationX-
b)<a.m_sensibility&&(b=a.m_oldAccelerationX);Math.abs(a.m_oldAccelerationY-c)<a.m_sensibility&&(c=a.m_oldAccelerationY);a.m_oldAccelerationX=b;a.m_oldAccelerationY=c;m=b/10;b=c/10;for(c=0;c<a.m_images.length;c++){var e=a.m_images[c],d=Number(e.dataset.maxMoveX),f=m*d*a.m_speed;f>d&&(f=d);f<-d&&(f=-d);d=Number(e.dataset.maxMoveY);var g=b*d*a.m_speed;g>d&&(g=d);g<-d&&(g=-d);e.style.transform="scale("+a.m_scaleFactor+") translate("+f+"px, "+g+"px)"}}}h=void 0===h?1.3:h;k=void 0===k?1:k;l=void 0===l?
30:l;var a=this;this.m_parent=q;this.m_speed=null;this.setSpeed=function(a){this.m_speed=a};this.getSpeed=function(){return this.m_speed};this.setSpeed(void 0===p?.7:p);this.m_scaleFactor=null;this.setScaleFactor=function(a){1>a&&(a=1);this.m_scaleFactor=a};this.getScaleFactor=function(){return this.m_scaleFactor};this.setScaleFactor(h);this.m_sensibility=null;this.setSensibility=function(a){this.m_sensibility=a};this.getSensibility=function(){return this.m_sensibility};this.setSensibility(k);this.m_frameRate=
null;this.setFrameRate=function(a){this.m_frameRate=1E3/a};this.getFrameRate=function(){return this.m_frameRate};this.setFrameRate(l);this.m_parents=[];this.m_images=[];this.updateImages=function(){this.m_parents=[];this.m_images=[];for(var a=0;a<this.m_parent.children.length;a++){this.m_parents.push(this.m_parent.children[a]);this.m_images.push(this.m_parents[a].getElementsByClassName("perspective-element")[0]);this.m_images[a].style.width="100%";this.m_images[a].style.height="100%";this.m_images[a].style.objectFit=
"cover";this.m_images[a].style.objectPosition="center center";this.m_images[a].style.transform="scale("+this.m_scaleFactor+")";this.m_parent.children[a].style.overflow="hidden";var b=this.m_images[a].offsetWidth,c=this.m_images[a].offsetHeight,e=c*(this.m_scaleFactor-.1);this.m_images[a].dataset.maxMoveX=Math.trunc((b*(this.m_scaleFactor-.1)-b)/2);this.m_images[a].dataset.maxMoveY=Math.trunc((e-c)/2)}};this.updateImages();window.addEventListener("resize",function(){a.updateImages()},!1);this.m_initialY=
this.m_initialX=null;var n=!1;this.m_oldAccelerationY=this.m_oldAccelerationX=null;this.resetOrientation=function(){this.m_initialY=this.m_initialX=null;n=!1;this.m_oldAccelerationY=this.m_oldAccelerationX=null};this.m_timer=Date.now();window.DeviceOrientationEvent&&window.addEventListener("devicemotion",r,!1)};